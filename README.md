# 橡胶接头价格管理与报价小工具

## 项目简介

橡胶接头价格管理与报价小工具是一个专为橡胶接头行业设计的报价辅助工具，可以帮助用户快速生成橡胶接头产品的报价单。该工具支持球体和法兰的价格管理，可以根据选择的配件自动计算产品成本价，并且允许用户设置利润百分比来生成销售价格，支持导出为PDF和Excel格式的报价单。

## 功能特点

1. **数据管理**：支持球体和法兰数据的导入、查看和管理
2. **基于利润的报价**：根据成本价加利润百分比自动计算销售价格
3. **报价导出**：支持导出为PDF和Excel格式的专业报价单
4. **成本管理**：记录成本价，支持显示/隐藏成本和利润率
5. **数据导入**：支持从CSV和Excel文件导入数据，也支持手动输入数据
6. **数据筛选**：可按类型和型号筛选产品数据，快速查找所需项目

## 安装说明

### 系统要求

- Windows 7/8/10/11
- Python 3.8 或更高版本

### 安装步骤

1. 安装Python环境（如果尚未安装）
2. 安装所需依赖包：
   ```
   pip install -r requirements.txt
   ```
3. 运行程序：
   ```
   python src/main.py
   ```

## 使用指南

### 初始设置

首次运行程序时，系统会自动加载一些示例数据，您可以通过以下方式开始使用：

1. 打开"设置"选项卡，设置您的公司名称和联系方式
2. 导入您的实际球体和法兰数据（如果有）

### 导入数据

您可以通过"数据导入"选项卡导入球体和法兰数据：

1. **批量导入数据**：支持从CSV和Excel文件导入数据
   - CSV文件格式示例（必须包含以下列）：type_name,model,cost_price
   - 球体和法兰数据分别导入

2. **手动输入数据**：
   - 在"手动添加数据"区域，选择对应选项卡（球体数据/法兰数据）
   - 输入类型、型号和成本价
   - 点击"添加球体数据"或"添加法兰数据"按钮保存
   - 如果已存在相同类型和型号的数据，可以选择更新成本价

3. **管理现有数据**：
   - 点击"查看数据"按钮可以查看已导入的数据
   - 在数据查看窗口中可以选择并删除不需要的数据
   - 使用筛选功能根据类型或型号筛选数据：
     * 从下拉菜单选择类型或型号，点击"筛选"按钮
     * 选择类型后，型号下拉菜单会自动更新以显示该类型的可用型号
     * 筛选结果会显示匹配的记录数量
     * 点击"重置"按钮可以清除筛选条件，显示所有数据

### 生成报价

1. 打开"快速报价"选项卡
2. 选择球体类型和型号
3. 选择法兰1和法兰2的类型和型号
4. 设置数量和利润百分比（默认为30%）
5. 点击"计算价格"查看成本价和销售价
6. 点击"添加到价格表"将该项目添加到报价单

### 导出报价单

1. 打开"导出报价单"选项卡
2. 设置保存目录和文件名
3. 选择是否显示成本价和利润率
4. 点击"导出为PDF"或"导出为Excel"按钮

## 数据文件

程序数据默认保存在应用程序目录下的data文件夹中：

- spheres.json：球体数据
- flanges.json：法兰数据
- quotations.json：报价记录
- settings.json：应用设置

## 许可证

本软件为内部使用工具，未经授权不得分发或商用。